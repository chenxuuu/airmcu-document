import{_ as c}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as a,o as i,c as l,a as n,b as s,d as t,w as u,e as p}from"./app-L4q_l0Kg.js";const r="/assets/formula-HijEyk6i.jpg",k="/assets/sht30_res-KVh5uWaG.png",d={},m=p('<h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><p>本章介绍使用Air001开发板驱动SHT30。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>SHT30是一款使用I²C通信接口的温湿度传感器。</p></div><h2 id="硬件准备" tabindex="-1"><a class="header-anchor" href="#硬件准备" aria-hidden="true">#</a> 硬件准备</h2>',4),v=n("code",null,"Air001",-1),b=n("code",null,"DAPLink调试器",-1),h=n("li",null,[n("p",null,[s("将"),n("code",null,"SHT30"),s("模块与"),n("code",null,"Air001开发板"),s("，按如下表格进行相连：")])],-1),_=p(`<table><thead><tr><th style="text-align:center;">SHT30</th><th style="text-align:center;">Air001</th></tr></thead><tbody><tr><td style="text-align:center;">GND</td><td style="text-align:center;">GND</td></tr><tr><td style="text-align:center;">VCC</td><td style="text-align:center;">3.3V</td></tr><tr><td style="text-align:center;">SCL</td><td style="text-align:center;">PF_1</td></tr><tr><td style="text-align:center;">SDA</td><td style="text-align:center;">PF_0</td></tr></tbody></table><div class="hint-container tip"><p class="hint-container-title">提示</p><p>I²C的<code>SCL</code>与<code>SDA</code>需要有上拉电阻，请确认外接的<code>SHT30</code>模块上有相应处理。</p></div><h2 id="软件部分" tabindex="-1"><a class="header-anchor" href="#软件部分" aria-hidden="true">#</a> 软件部分</h2><p>代码如下:</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Wire.h&gt;</span></span>
<span class="token comment">//SHT30 I²C通信从机地址为0x44</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">Addr_SHT30</span> <span class="token expression"><span class="token number">0x44</span></span></span>
<span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//设定SCL和SDA引脚</span>
  Wire<span class="token punctuation">.</span><span class="token function">setSDA</span><span class="token punctuation">(</span>PF_0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">setSCL</span><span class="token punctuation">(</span>PF_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//初始化I²C</span>
  Wire<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//设定波特率为9600</span>
  Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">9600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//延时</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//定义数组以存储获取的6个数据</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">char</span> data<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">//开始传输，设置I²C从机地址</span>
  Wire<span class="token punctuation">.</span><span class="token function">beginTransmission</span><span class="token punctuation">(</span>Addr_SHT30<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//发送测量命令0x2C06,由于一次只能发一个8位数据，因此分开发两次</span>
  Wire<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0x2C</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0x06</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//I²C停止</span>
  Wire<span class="token punctuation">.</span><span class="token function">endTransmission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//延时（等待测量数据）</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//请求获取6字节的数据，传入对应的从机地址</span>
  Wire<span class="token punctuation">.</span><span class="token function">requestFrom</span><span class="token punctuation">(</span>Addr_SHT30<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//判断是否成功读取到6个字节</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Wire<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//成功读取，则将数据存入data数组</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Wire<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//读取失败则打印&quot;error!&quot;</span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;error!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//计算得到的数据将其转化为直观的温度和湿度，公式参考下方说明</span>
  <span class="token keyword">int</span> cTemp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">175</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">65535</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">45</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> humidity <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">65535</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//在串口里输出得到的数据</span>
  Serial<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;湿度：%d%%RH\\n&quot;</span><span class="token punctuation">,</span>humidity<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;温度：%d℃&quot;</span><span class="token punctuation">,</span>cTemp<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//延时</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),f={href:"https://sensirion.com/media/documents/213E6A3B/63A5A569/Datasheet_SHT3x_DIS.pdf",target:"_blank",rel:"noopener noreferrer"},y=n("figure",null,[n("img",{src:r,alt:"计算公式",tabindex:"0",loading:"lazy"}),n("figcaption",null,"计算公式")],-1),g=n("h2",{id:"输出结果",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#输出结果","aria-hidden":"true"},"#"),s(" 输出结果")],-1),x=n("p",null,"在串口监视器中将波特率调至9600，可观察到当前温湿度，如下图:",-1),S=n("figure",null,[n("img",{src:k,alt:"串口打印",tabindex:"0",loading:"lazy"}),n("figcaption",null,"串口打印")],-1);function w(A,T){const e=a("RouterLink"),o=a("ExternalLinkIcon");return i(),l("div",null,[m,n("ul",null,[n("li",null,[n("p",null,[s("按"),t(e,{to:"/tutorial-advanced/Air001_start.html"},{default:u(()=>[s("☁️ Air001开发板入门")]),_:1}),s("，将"),v,s("和"),b,s("使用排针排母连接。")])]),h]),_,n("p",null,[s("温湿度计算公式可以参考"),n("a",f,[s("官方文档"),t(o)]),s("：")]),y,g,x,S])}const W=c(d,[["render",w],["__file","SHT30.html.vue"]]);export{W as default};
