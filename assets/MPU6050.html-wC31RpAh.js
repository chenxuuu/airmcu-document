import{_ as p}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as e,o,c,a as n,b as s,d as i,w as u,e as a}from"./app-L4q_l0Kg.js";const l="/assets/g-1_AIDW6G.jpg",k="/assets/a0-u27PFD1F.jpg",r="/assets/a_x-n7JseYo_.jpg",d="/assets/MPU6050_res-RuW4RcJT.png",m={},v=a('<h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><p>本章介绍使用Air001开发板驱动MPU6050。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>MPU6050使用I²C通信接口，内部整合了三轴MEMS陀螺仪、三轴MEMS加速度计和一个内置温度传感器，可以读取三轴角度，三轴加速度以及当前温度。</p></div><h2 id="硬件准备" tabindex="-1"><a class="header-anchor" href="#硬件准备" aria-hidden="true">#</a> 硬件准备</h2>',4),b=n("code",null,"Air001",-1),g=n("code",null,"DAPLink调试器",-1),f=n("li",null,[n("p",null,[s("将"),n("code",null,"MPU6050"),s("模块与"),n("code",null,"Air001开发板"),s("，按如下表格进行相连：")])],-1),h=a('<table><thead><tr><th style="text-align:center;">MPU6050</th><th style="text-align:center;">Air001</th></tr></thead><tbody><tr><td style="text-align:center;">GND</td><td style="text-align:center;">GND</td></tr><tr><td style="text-align:center;">VCC</td><td style="text-align:center;">3.3V</td></tr><tr><td style="text-align:center;">SCL</td><td style="text-align:center;">PF_1</td></tr><tr><td style="text-align:center;">SDA</td><td style="text-align:center;">PF_0</td></tr></tbody></table><div class="hint-container tip"><p class="hint-container-title">提示</p><p>剩余的<code>XDA</code>,<code>XCL</code>,<code>ADO</code>,<code>INT</code>引脚不用连接。</p></div><details class="hint-container details"><summary>关于MPU6050的方向</summary><ul><li>对于陀螺仪：令芯片表面(有文字的一面)朝上，将其表面文字转至正向自己，以芯片内部中心为原点，水平向右的为X轴正方向，水平指向外侧的为Y轴正方向，竖直向上的为Z轴正方向。</li></ul><figure><img src="'+l+'" alt="陀螺仪方向示意" tabindex="0" loading="lazy"><figcaption>陀螺仪方向示意</figcaption></figure><ul><li>对于加速度计： 假想一个不受任何外力作用的球漂浮在正方体盒子中心，此时三轴加速度为0。当小球偏向任何一个方向时，为了保持静止，它自身将具有相反方向的加速度。</li></ul><figure><img src="'+k+'" alt="加速度计方向示意" tabindex="0" loading="lazy"><figcaption>加速度计方向示意</figcaption></figure><figure><img src="'+r+`" alt="小球的位置偏向X轴的负向，因此X轴的加速度读数应为正" tabindex="0" loading="lazy"><figcaption>小球的位置偏向X轴的负向，因此X轴的加速度读数应为正</figcaption></figure></details><h2 id="软件部分" tabindex="-1"><a class="header-anchor" href="#软件部分" aria-hidden="true">#</a> 软件部分</h2><p>我们只需要使用Arduino自带的<code>Wire</code>库。</p><p>代码如下：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;Wire.h&gt;</span></span>
<span class="token comment">//定义数组用于存放测量的三轴角度、三轴加速度和温度</span>
<span class="token keyword">int16_t</span> data<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//MPU6050的总线地址是0x68</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> mpu_addr <span class="token operator">=</span><span class="token number">0x68</span><span class="token punctuation">;</span>
<span class="token comment">//依据加速度计和陀螺仪的量程设定精度</span>
<span class="token keyword">const</span> <span class="token keyword">uint16_t</span> AccelScaleFactor <span class="token operator">=</span> <span class="token number">16384</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">uint16_t</span> GyroScaleFactor <span class="token operator">=</span> <span class="token number">131</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><ul><li>加速度计的范围有2g、4g、8g、16g可选。</li><li>陀螺仪的范围有±250、±500、±1000、±2000可选，而对应的精度分别是131LSB/(°/s)、65.5LSB/(°/s)、32.8LSB/(°/s)、16.4 LSB/(°/s)。</li></ul></div><p>定义<code>getData</code>函数来读取MPU6050测量的数据并依次赋给数组<code>data[]</code>。</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//开启MPU6050的传输</span>
  Wire<span class="token punctuation">.</span><span class="token function">beginTransmission</span><span class="token punctuation">(</span>mpu_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//寄存器的地址为0x3b</span>
  Wire<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0x3b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//结束传输</span>
  Wire<span class="token punctuation">.</span><span class="token function">endTransmission</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//获取7个数据，每个两位</span>
  Wire<span class="token punctuation">.</span><span class="token function">requestFrom</span><span class="token punctuation">(</span>mpu_addr<span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//赋值</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>byte i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">7</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Wire<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span> Wire<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>setup</code>函数中添加如下代码：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//设定SCL、SDA引脚</span>
  Wire<span class="token punctuation">.</span><span class="token function">setSCL</span><span class="token punctuation">(</span>PF_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">setSDA</span><span class="token punctuation">(</span>PF_0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//初始化I²C接口</span>
  Wire<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//初始化陀螺仪参数</span>
  Wire<span class="token punctuation">.</span><span class="token function">beginTransmission</span><span class="token punctuation">(</span>mpu_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0x6B</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">endTransmission</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//初始化加速度计参数</span>
  Wire<span class="token punctuation">.</span><span class="token function">beginTransmission</span><span class="token punctuation">(</span>mpu_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0x1c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0x08</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Wire<span class="token punctuation">.</span><span class="token function">endTransmission</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//初始化串口，用于输出日志</span>
  Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">9600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后在<code>loop</code>函数中添加其余代码：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//声明双精度实型变量三轴加速度，温度，和三轴角度</span>
  <span class="token keyword">double</span> Ax<span class="token punctuation">,</span> Ay<span class="token punctuation">,</span> Az<span class="token punctuation">,</span> T<span class="token punctuation">,</span> Gx<span class="token punctuation">,</span> Gy<span class="token punctuation">,</span> Gz<span class="token punctuation">;</span>
  <span class="token comment">//引用之前定义的函数读取数据</span>
  <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//赋值</span>
  Ax <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>AccelScaleFactor<span class="token punctuation">;</span>
  Ay <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>AccelScaleFactor<span class="token punctuation">;</span>
  Az <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">/</span>AccelScaleFactor<span class="token punctuation">;</span>
  T <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">340</span><span class="token operator">+</span><span class="token number">36.53</span><span class="token punctuation">;</span>
  Gx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">/</span>GyroScaleFactor<span class="token punctuation">;</span>
  Gy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">/</span>GyroScaleFactor<span class="token punctuation">;</span>
  Gz <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">/</span>GyroScaleFactor<span class="token punctuation">;</span>
  <span class="token comment">//输出三轴加速度</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; Ax:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>Ax<span class="token punctuation">)</span><span class="token punctuation">;</span>Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; Ay:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>Ay<span class="token punctuation">)</span><span class="token punctuation">;</span>Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; Az:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>Az<span class="token punctuation">)</span><span class="token punctuation">;</span>Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//输出三轴角度</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; Gx:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>Gx<span class="token punctuation">)</span><span class="token punctuation">;</span>Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; Gy:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>Gy<span class="token punctuation">)</span><span class="token punctuation">;</span>Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; Gz:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>Gz<span class="token punctuation">)</span><span class="token punctuation">;</span>Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//输出温度</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot; T:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//换行</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//延时</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="输出结果" tabindex="-1"><a class="header-anchor" href="#输出结果" aria-hidden="true">#</a> 输出结果</h2><p>在串口监视器中将波特率调至9600，可观察到当前状态和温度，如下图:</p><figure><img src="`+d+'" alt="串口打印" tabindex="0" loading="lazy"><figcaption>串口打印</figcaption></figure>',17);function y(_,x){const t=e("RouterLink");return o(),c("div",null,[v,n("ul",null,[n("li",null,[n("p",null,[s("按"),i(t,{to:"/tutorial-advanced/Air001_start.html"},{default:u(()=>[s("☁️ Air001开发板入门")]),_:1}),s("，将"),b,s("和"),g,s("使用排针排母连接。")])]),f]),h])}const q=p(m,[["render",y],["__file","MPU6050.html.vue"]]);export{q as default};
